---
title: "Time Series Analysis Sheet 5"
author: "Tom Kniepkamp"
date: "5 May 2022"
output: html_document
---

## Problem 14 (Linear Filter)

### 1. *In what sense is a linear filter linear?*

### 2. 

### 3. What is the advantage of a causal filter over a non- causal filter

- Causal filters have real- time applications while non- causal filters cannot be observed using real data.

- Non- causal filters possibly use data from future time periods which are not observable. 

## Problem 15 ()


## Problem 17 

The monthly time series seems to follow a linear trend (see figure below) and 
yearly seaonsal patterns. A linear OLS estimate is applied to estimate the linear trend in price increases. 

OLS: 

$y_t = \hat{\beta}_0 + \hat{\beta}_1 t + \varepsilon$

From slide 5/40, we get $p = 1$ and therefore $\Delta^2 m_t = 0$.

```{r}
pacman:: p_load(stats)
```



```{r}
# load data and create TS for monthly data
df <- read.table(file = "Transport.txt")
df <- ts(data = df, start = 1993,  deltat = 1/12, names = "Transport")

t <- time(df) 

# use a linear regression model to predict the plot

reg_0 <- lm(df ~ t ) # Model a quadratic trend wrt time t

# Plot the time series with the fit line
plot(df, type = "l", main = "Plot of the Time Series")
points(t, predict.lm(reg_0), type = 'l', col = 'red')
```

```{r}
plot(reg_0) # residuals are not normally distributed due to seasonality

```


Now, we create a high- pass difference filter with respect to the fitted values
of the OLS estimators created above. This will eliminate the trend and keep the 
seasonality. 

```{r}
a <- sort(predict.lm(reg_0), decreasing = T)

f <- filter(df, filter = predict.lm(reg_0), method = "recursive")

plot(f)
```




